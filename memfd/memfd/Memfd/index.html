<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Memfd (memfd.Memfd)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">Index</a> &#x00BB; <a href="../index.html">memfd</a> &#x00BB; Memfd</nav><header class="odoc-preamble"><h1>Module <code><span>Memfd</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-huge_tlb_flag"><a href="#type-huge_tlb_flag" class="anchor"></a><code><span><span class="keyword">type</span> huge_tlb_flag</span><span> = </span></code><ol><li id="type-huge_tlb_flag.Huge_TLB_64KB" class="def variant constructor anchored"><a href="#type-huge_tlb_flag.Huge_TLB_64KB" class="anchor"></a><code><span>| </span><span><span class="constructor">Huge_TLB_64KB</span></span></code></li><li id="type-huge_tlb_flag.Huge_TLB_512KB" class="def variant constructor anchored"><a href="#type-huge_tlb_flag.Huge_TLB_512KB" class="anchor"></a><code><span>| </span><span><span class="constructor">Huge_TLB_512KB</span></span></code></li><li id="type-huge_tlb_flag.Huge_TLB_1MB" class="def variant constructor anchored"><a href="#type-huge_tlb_flag.Huge_TLB_1MB" class="anchor"></a><code><span>| </span><span><span class="constructor">Huge_TLB_1MB</span></span></code></li><li id="type-huge_tlb_flag.Huge_TLB_2MB" class="def variant constructor anchored"><a href="#type-huge_tlb_flag.Huge_TLB_2MB" class="anchor"></a><code><span>| </span><span><span class="constructor">Huge_TLB_2MB</span></span></code></li><li id="type-huge_tlb_flag.Huge_TLB_8MB" class="def variant constructor anchored"><a href="#type-huge_tlb_flag.Huge_TLB_8MB" class="anchor"></a><code><span>| </span><span><span class="constructor">Huge_TLB_8MB</span></span></code></li><li id="type-huge_tlb_flag.Huge_TLB_16MB" class="def variant constructor anchored"><a href="#type-huge_tlb_flag.Huge_TLB_16MB" class="anchor"></a><code><span>| </span><span><span class="constructor">Huge_TLB_16MB</span></span></code></li><li id="type-huge_tlb_flag.Huge_TLB_32MB" class="def variant constructor anchored"><a href="#type-huge_tlb_flag.Huge_TLB_32MB" class="anchor"></a><code><span>| </span><span><span class="constructor">Huge_TLB_32MB</span></span></code></li><li id="type-huge_tlb_flag.Huge_TLB_256MB" class="def variant constructor anchored"><a href="#type-huge_tlb_flag.Huge_TLB_256MB" class="anchor"></a><code><span>| </span><span><span class="constructor">Huge_TLB_256MB</span></span></code></li><li id="type-huge_tlb_flag.Huge_TLB_512MB" class="def variant constructor anchored"><a href="#type-huge_tlb_flag.Huge_TLB_512MB" class="anchor"></a><code><span>| </span><span><span class="constructor">Huge_TLB_512MB</span></span></code></li><li id="type-huge_tlb_flag.Huge_TLB_1GB" class="def variant constructor anchored"><a href="#type-huge_tlb_flag.Huge_TLB_1GB" class="anchor"></a><code><span>| </span><span><span class="constructor">Huge_TLB_1GB</span></span></code></li><li id="type-huge_tlb_flag.Huge_TLB_2GB" class="def variant constructor anchored"><a href="#type-huge_tlb_flag.Huge_TLB_2GB" class="anchor"></a><code><span>| </span><span><span class="constructor">Huge_TLB_2GB</span></span></code></li><li id="type-huge_tlb_flag.Huge_TLB_16GB" class="def variant constructor anchored"><a href="#type-huge_tlb_flag.Huge_TLB_16GB" class="anchor"></a><code><span>| </span><span><span class="constructor">Huge_TLB_16GB</span></span></code></li></ol></div><div class="spec-doc"><p>Type of huge page sizes. The most common sizes are 2MB and 1GB. Check /proc/meminfo for the size your system currently uses.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-seal_flag"><a href="#type-seal_flag" class="anchor"></a><code><span><span class="keyword">type</span> seal_flag</span><span> = </span></code><ol><li id="type-seal_flag.Seal_seal" class="def variant constructor anchored"><a href="#type-seal_flag.Seal_seal" class="anchor"></a><code><span>| </span><span><span class="constructor">Seal_seal</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>F_SEAL_SEAL</p><span class="comment-delim">*)</span></div></li><li id="type-seal_flag.Seal_shrink" class="def variant constructor anchored"><a href="#type-seal_flag.Seal_shrink" class="anchor"></a><code><span>| </span><span><span class="constructor">Seal_shrink</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>F_SEAL_SHRINK</p><span class="comment-delim">*)</span></div></li><li id="type-seal_flag.Seal_grow" class="def variant constructor anchored"><a href="#type-seal_flag.Seal_grow" class="anchor"></a><code><span>| </span><span><span class="constructor">Seal_grow</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>F_SEAL_GROW</p><span class="comment-delim">*)</span></div></li><li id="type-seal_flag.Seal_write" class="def variant constructor anchored"><a href="#type-seal_flag.Seal_write" class="anchor"></a><code><span>| </span><span><span class="constructor">Seal_write</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>F_SEAL_WRITE</p><span class="comment-delim">*)</span></div></li><li id="type-seal_flag.Seal_future_write" class="def variant constructor anchored"><a href="#type-seal_flag.Seal_future_write" class="anchor"></a><code><span>| </span><span><span class="constructor">Seal_future_write</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>F_SEAL_FUTURE_WRITE</p><span class="comment-delim">*)</span></div></li><li id="type-seal_flag.Invalid_seal" class="def variant constructor anchored"><a href="#type-seal_flag.Invalid_seal" class="anchor"></a><code><span>| </span><span><span class="constructor">Invalid_seal</span></span></code></li></ol></div><div class="spec-doc"><p>Type of file sealing flags.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-memfd_err"><a href="#type-memfd_err" class="anchor"></a><code><span><span class="keyword">type</span> memfd_err</span><span> = </span></code><ol><li id="type-memfd_err.Create_fd" class="def variant constructor anchored"><a href="#type-memfd_err.Create_fd" class="anchor"></a><code><span>| </span><span><span class="constructor">Create_fd</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Generic memfd_create failure</p><span class="comment-delim">*)</span></div></li><li id="type-memfd_err.Create_fd_ver" class="def variant constructor anchored"><a href="#type-memfd_err.Create_fd_ver" class="anchor"></a><code><span>| </span><span><span class="constructor">Create_fd_ver</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Linux kernel version is less than 3.17</p><span class="comment-delim">*)</span></div></li><li id="type-memfd_err.Create_fd_sealing_hugetlb" class="def variant constructor anchored"><a href="#type-memfd_err.Create_fd_sealing_hugetlb" class="anchor"></a><code><span>| </span><span><span class="constructor">Create_fd_sealing_hugetlb</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Linux kernel version must be over 4.16 to enable both sealing and huge page</p><span class="comment-delim">*)</span></div></li><li id="type-memfd_err.Resize_fd" class="def variant constructor anchored"><a href="#type-memfd_err.Resize_fd" class="anchor"></a><code><span>| </span><span><span class="constructor">Resize_fd</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Resize failure</p><span class="comment-delim">*)</span></div></li><li id="type-memfd_err.Add_seal" class="def variant constructor anchored"><a href="#type-memfd_err.Add_seal" class="anchor"></a><code><span>| </span><span><span class="constructor">Add_seal</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Add seal failure</p><span class="comment-delim">*)</span></div></li><li id="type-memfd_err.Get_seal" class="def variant constructor anchored"><a href="#type-memfd_err.Get_seal" class="anchor"></a><code><span>| </span><span><span class="constructor">Get_seal</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Get seal failure</p><span class="comment-delim">*)</span></div></li></ol></div><div class="spec-doc"><p>Type of memfd ops errors.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-memfd_opts"><a href="#type-memfd_opts" class="anchor"></a><code><span><span class="keyword">type</span> memfd_opts</span><span> = </span><span>{</span></code><ol><li id="type-memfd_opts.allow_sealing" class="def record field anchored"><a href="#type-memfd_opts.allow_sealing" class="anchor"></a><code><span>allow_sealing : bool;</span></code></li><li id="type-memfd_opts.cloexec" class="def record field anchored"><a href="#type-memfd_opts.cloexec" class="anchor"></a><code><span>cloexec : bool;</span></code></li><li id="type-memfd_opts.huge_tlb_flag" class="def record field anchored"><a href="#type-memfd_opts.huge_tlb_flag" class="anchor"></a><code><span>huge_tlb_flag : <span><a href="#type-huge_tlb_flag">huge_tlb_flag</a> option</span>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Type of memfd creation options.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-make_memfd_opts"><a href="#val-make_memfd_opts" class="anchor"></a><code><span><span class="keyword">val</span> make_memfd_opts : 
  <span><span class="label">allow_sealing</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">cloexec</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">huge_tlb_flag</span>:<span><a href="#type-huge_tlb_flag">huge_tlb_flag</a> option</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-memfd_opts">memfd_opts</a></span></code></div><div class="spec-doc"><p><code>make_memfd_opts</code> <code>allow_sealing</code> <code>cloexec</code> <code>huge_tlb_flag</code> makes the memfd options.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-make_default_memfd_opts"><a href="#val-make_default_memfd_opts" class="anchor"></a><code><span><span class="keyword">val</span> make_default_memfd_opts : <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="#type-memfd_opts">memfd_opts</a></span></code></div><div class="spec-doc"><p><code>make_default_memfd_opts</code> makes the memfd options with default options</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-make_memfd"><a href="#val-make_memfd" class="anchor"></a><code><span><span class="keyword">val</span> make_memfd : 
  <span><span class="label">name</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">memfd_opts</span>:<a href="#type-memfd_opts">memfd_opts</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(int, <a href="#type-memfd_err">memfd_err</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p><code>make_memfd</code> <code>name</code> <code>opts</code> makes the memfd using <code>name</code> and <code>memfd_opts</code> as options.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-memfd_resize"><a href="#val-memfd_resize" class="anchor"></a><code><span><span class="keyword">val</span> memfd_resize : <span><span class="label">memfd</span>:int <span class="arrow">&#45;&gt;</span></span> <span><span class="label">size</span>:int <span class="arrow">&#45;&gt;</span></span> <span><span>(unit, <a href="#type-memfd_err">memfd_err</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p><code>memfd_resize</code> sets a <code>memfd</code> to <code>size</code>. If huge page is enabled, you must set the size to the align with your page size, e.g. if page size is 2MB, you can set 2 * 1024 * 1024. Enough huge pages must also be free.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-memfd_add_seals"><a href="#val-memfd_add_seals" class="anchor"></a><code><span><span class="keyword">val</span> memfd_add_seals : 
  <span><span class="label">memfd</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">sl</span>:<span><a href="#type-seal_flag">seal_flag</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(unit, <a href="#type-memfd_err">memfd_err</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p><code>memfd_add_seals</code> adds a list of seals <code>sl</code> to a <code>memfd</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-memfd_get_seals"><a href="#val-memfd_get_seals" class="anchor"></a><code><span><span class="keyword">val</span> memfd_get_seals : <span><span class="label">memfd</span>:int <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><a href="#type-seal_flag">seal_flag</a> list</span>, <a href="#type-memfd_err">memfd_err</a>)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p><code>memfd_get_seals</code> gets a list of seals from a <code>memfd</code>. Also doubles as a validator for whether a file descriptor is a memfd.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-int_of_seal_flag"><a href="#val-int_of_seal_flag" class="anchor"></a><code><span><span class="keyword">val</span> int_of_seal_flag : <span><a href="#type-seal_flag">seal_flag</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p><code>int_of_seal_flag</code> is a helper that converts a seal_flag to integer.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-seal_flag_of_string"><a href="#val-seal_flag_of_string" class="anchor"></a><code><span><span class="keyword">val</span> seal_flag_of_string : <span>int <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p><code>seal_flag_of_string</code> is a helper that converts a seal_flag in integer representation to string.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-memfd_err_to_string"><a href="#val-memfd_err_to_string" class="anchor"></a><code><span><span class="keyword">val</span> memfd_err_to_string : <span><a href="#type-memfd_err">memfd_err</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div></div></div></body></html>
